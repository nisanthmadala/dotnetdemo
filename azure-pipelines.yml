trigger:
- main
- develop
- feature/*

pool:
  vmImage: 'windows-latest'


variables:
  buildConfiguration: 'Release'

steps:
- task: DotNetCoreCLI@2
  inputs:
   command: 'build'
   arguments: '--configuration $(buildConfiguration)'
  displayName: 'dotnet build $(buildConfiguration)'


- task: DotNetCoreCLI@2
  inputs:
   command: 'publish'
   arguments: '--configuration $(buildConfiguration)'
   publishWebProjects: true
  displayName: 'dotnet build $(buildConfiguration)'
  
- task: DotNetCoreCLI@2
  inputs:
   command: 'test'
   arguments: '--configuration $(buildConfiguration)'
  displayName: 'dotnet build $(buildConfiguration)'
  

- task: KubernetesManifest@1
  inputs:
    action: 'deploy'
    connectionType: 'kubernetesServiceConnection'
    kubernetesServiceConnection: 'batch33'
    namespace: 'kube-system'
    manifests: 'service.yaml'
    containers: 'myindia'
    rolloutStatusTimeout: '1'